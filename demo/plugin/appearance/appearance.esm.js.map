{"version":3,"file":"appearance.esm.js","sources":["../../../src/plugin/js/helpers.js","../../../src/plugin/js/functions/get-load-css.js","../../../src/plugin/js/functions/add-auto-animation.js","../../../src/plugin/js/functions/fix-list-item.js","../../../src/plugin/js/functions/add-base-class.js","../../../src/plugin/js/functions/add-delay.js","../../../src/plugin/js/functions/get-appearance-arrays.js","../../../src/plugin/js/functions/convert-to-spans.js","../../../src/plugin/js/functions/show-hide-slide.js","../../../src/plugin/js/plugin.js"],"sourcesContent":["/**\n * Check if a given string is valid JSON.\n * @param {string} str - The string to be checked.\n * @returns {boolean} `true` if the string is valid JSON, otherwise `false`.\n */\nexport const isJSON = str => {\n\ttry {\n\t\treturn (JSON.parse(str) && !!str);\n\t} catch (e) {\n\t\treturn false;\n\t}\n};\n\n/**\n * Convert a NodeList into an array based on provided selectors.\n * @param {Element} container - The root element to begin querying.\n * @param {string} selectors - A string containing one or more CSS selectors separated by commas.\n * @returns {Element[]} Array of elements that match the given selectors.\n */\nexport const selectionArray = (container, selectors) => {\n\tlet selections = container.querySelectorAll(selectors);\n\tlet selectionarray = Array.prototype.slice.call(selections);\n\treturn selectionarray;\n};\n\n/**\n * Check if an element has child nodes that are `SECTION` elements.\n * @param {Object} param0 - Object with childNodes property.\n * @param {NodeListOf<ChildNode>} param0.childNodes - List of child nodes of the element.\n * @returns {boolean} `true` if the element contains `SECTION` child nodes, otherwise `false`.\n */\nexport const isStack = ({childNodes}) => {\n\tlet isStack = false;\n\tfor (let i = 0; i < childNodes.length; i++) {\n\t\tif (childNodes[i].tagName == \"SECTION\") {\n\t\t\tisStack = true;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn isStack;\n};\n\n/**\n * Copy data attributes from a source element to a target element with an optional exception.\n * @param {Object} param0 - Object with attributes property.\n * @param {NamedNodeMap} param0.attributes - Map of attributes of the source element.\n * @param {Element} target - Target element to copy attributes to.\n * @param {string} [not] - Optional attribute name to exclude from copying.\n */\nexport const copyDataAttributes = ({attributes}, target, not) => {\n\t[...attributes].filter(({nodeName}) => nodeName.includes('data')).forEach(({nodeName, nodeValue}) => {\n\t\tif ((not && nodeName !== not) || !not) {\n\t\t\ttarget.setAttribute(nodeName, nodeValue);\n\t\t}\n\t});\n};\n\n/**\n * Check if the given item is an object and not an array.\n * @param {*} item - The item to be checked.\n * @returns {boolean} `true` if the item is an object and not an array, otherwise `false`.\n */\nconst isObject = (item) => {\n\treturn (item && typeof item === 'object' && !Array.isArray(item));\n}\n\n/**\n * Deep merge multiple objects into a target object.\n * @param {Object} target - Target object to merge values into.\n * @param {...Object} sources - Source objects to merge from.\n * @returns {Object} The merged object.\n */\nexport const mergeDeep = (target, ...sources) => {\n\tif (!sources.length) return target;\n\tconst source = sources.shift();\n\n\tif (isObject(target) && isObject(source)) {\n\t\tfor (const key in source) {\n\t\t\tif (isObject(source[key])) {\n\t\t\t\tif (!target[key]) Object.assign(target, { [key]: {} });\n\t\t\t\tmergeDeep(target[key], source[key]);\n\t\t\t} else {\n\t\t\t\tObject.assign(target, { [key]: source[key] });\n\t\t\t}\n\t\t}\n\t}\n\treturn mergeDeep(target, ...sources);\n}\n\n/**\n * Resolves the given Promise immediately using setTimeout.\n * @param {Function} resolve - The resolve function of a Promise.\n * @returns {number} The ID value of the timer that is set.\n */\nexport const doneLoading = (resolve) => {\n\treturn setTimeout(resolve, 0);\n}\n\n\n/**\n * Converts a JavaScript object or a JSON-formatted string to a JSON string.\n *\n * @param {Object|string} str - The input string or object to be converted to a JSON string.\n * @returns {string} The JSON string.\n */\nexport const toJSONString = (str) => {\n\tlet JSONString = ''\n\n\tif (typeof str === \"string\") str = str.replace(/[“”]/g,'\"').replace(/[‘’]/g,\"'\");\n\n\tif (isJSON(str)) {\n\t\tJSONString = str\n\t} else {\n\t\tif (typeof str === \"object\") {\n\t\t\tJSONString = JSON.stringify(str, null, 2)\n\t\t} else {\n\t\t\tJSONString = str.trim().replace(/'/g, '\"').charAt(0) === \"{\" ? str.trim().replace(/'/g, '\"') : `{${str.trim().replace(/'/g, '\"')}}`;\n\t\t}\n\t}\n\treturn JSONString;\n}\n\n/**\n * Dynamically loads a stylesheet from the specified URL and calls a callback function when it's loaded.\n *\n * @param {string} url - The URL of the stylesheet to load.\n * @param {Function} callback - A callback function to be called when the stylesheet is loaded.\n */\nexport const loadStyle = (url, callback) => {\n\tconst head = document.querySelector('head');\n\tconst style = document.createElement('link');\n\tstyle.rel = 'stylesheet';\n\tstyle.href = url;\n\tstyle.onload = () => {\n\t\tif (typeof callback === 'function') {\n\t\t\tcallback.call();\n\t\t\tcallback = null;\n\t\t}\n\t};\n\tstyle.onreadystatechange = () => {\n\t\tif (style.readyState === 'loaded') {\n\t\t\tstyle.onload();\n\t\t}\n\t};\n\thead.appendChild(style);\n};\n\n/**\n * Retrieves the path of a JavaScript file based on its filename.\n *\n * @param {string} fileName - The filename of the script.\n * @returns {string} The path to the plugin's location.\n */\nexport const pluginPath = (fileName) => {\n\tlet path;\n\tlet pluginScript = document.querySelector(`script[src$=\"${fileName}\"]`);\n\tif (pluginScript) {\n\t\tpath = pluginScript.getAttribute(\"src\").slice(0, -1 * (fileName.length));\n\t} else {\n\t\tpath = import.meta.url.slice(0, import.meta.url.lastIndexOf('/') + 1);\n\t}\n\treturn path;\n}\n\n\n\nexport const debugLog = (options, text) => {\n\tif (options.debug) console.log(text);\n}\n","import { loadStyle } from '../helpers';\nimport { pluginPath } from '../helpers';\n\n/**\n * Retrieves and loads CSS stylesheets based on the provided options and ES5 filename.\n *\n * @param {Object} options - Configuration options for loading CSS.\n * @param {string} fileName - The filename of the script.\n */\n\nexport const getAndLoadCSS = (options, fileName) => {\n\tlet thePath = pluginPath(fileName);\n\tlet pluginBaseName = fileName.replace(/\\.[^/.]+$/, \"\");\n\n\tlet AppearanceStylePath = options.csspath.appearance ? options.csspath.appearance : null || `${thePath}${pluginBaseName}.css` || `plugin/${pluginBaseName}/${pluginBaseName}.css`\n\tlet AnimateCSSPath = !options.compatibility ? options.animatecsspath.link : options.animatecsspath.compat;\n\n\tif (options.debug) {\n\t\tconsole.log(`Paths:`);\n\t\tconsole.log(`  - Plugin path = ${thePath}`);\n\t\tconsole.log(`  - Appearance CSS path = ${AppearanceStylePath}`);\n\t\tconsole.log(`  - AnimateCSS CSS path = ${AnimateCSSPath}`);\n\t}\n\n\tloadStyle(AnimateCSSPath, function () {\n\t\tloadStyle(AppearanceStylePath);\n\t});\n\n}","import { toJSONString } from '../helpers';\n\n\n/**\n * Adds automatic animations to elements within a section based on specified criteria.\n *\n * This function examines the provided section for attributes and options to determine\n * which classes should be added to its elements to enable automatic animations.\n *\n * @param {HTMLElement} section - The section element to which automatic animations will be applied.\n * @param {Object} options - The existing user options object\n * @param {Object} vars - The existing vars object\n * @returns {undefined}\n */\nexport const addAutoAnimation = (section, options, vars) => {\n\n\tlet sectionAutoSelectors = null;\n\n\tif (section.hasAttribute(\"data-autoappear\")) {\n\n\t\tlet sectDataAppear = section.dataset.autoappear;\n\n\t\tif (sectDataAppear == \"auto\" || sectDataAppear == \"\" || sectDataAppear.length < 1 || sectDataAppear == \"true\") {\n\t\t\t// This section should get the global autoappear classes on its objects\n\t\t\tsectionAutoSelectors = options.autoelements ? options.autoelements : null;\n\t\t} else {\n\t\t\t// This section should get the local autoappear classes on its objects\n\t\t\tsectionAutoSelectors = sectDataAppear;\n\t\t}\n\n\t} else if ( options.autoappear && options.autoelements ) {\n\t\t// This section should get the global autoappear classes on its objects\n\t\tsectionAutoSelectors = options.autoelements;\n\t}\n\n\tif (sectionAutoSelectors) {\n\n\t\tlet elementsToAnimate = JSON.parse(toJSONString(sectionAutoSelectors));\n\n\t\tObject.entries(elementsToAnimate).forEach(([selector, assignables]) => {\n\n\n\t\t\t// Exclude the elements from vars.appearances\n\t\t\tlet elements = Array.from(section.querySelectorAll(selector)).filter( element => !vars.appearances.includes(element) );\n\n\t\t\tif (elements.length) {\n\n\t\t\t\telements.forEach((element) => {\n\n\t\t\t\t\tvars.appearances.push(element)\n\n\t\t\t\t\tlet newClasses = [], newDelay = null, speedClass = false, elementSplit = null, containerDelay = null;\n\n\t\t\t\t\tif (Array.isArray(assignables)) {\n\n\t\t\t\t\t\tnewClasses = assignables[0].split(/[ ,]+/);\n\t\t\t\t\t\tnewDelay = assignables[1];\n\n\t\t\t\t\t} else if (typeof assignables == \"string\"){\n\n\t\t\t\t\t\tnewClasses = assignables.split(/[ ,]+/);\n\n\t\t\t\t\t} else if (assignables.constructor === Object) {\n\n\t\t\t\t\t\tif (assignables.class || assignables.animation) {\n\t\t\t\t\t\t\tlet animationClass = assignables.animation ? assignables.animation : assignables.class;\n\t\t\t\t\t\t\tnewClasses = animationClass.split(/[ ,]+/);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (assignables.speed) {\n\t\t\t\t\t\t\tspeedClass = String(assignables.speed);\n\t\t\t\t\t\t\tif (!speedClass.includes(\"animate__\")) {\n\t\t\t\t\t\t\t\tspeedClass = `animate__${speedClass}`\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (assignables.delay) {\n\t\t\t\t\t\t\tnewDelay = String(assignables.delay);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (assignables.split) {\n\t\t\t\t\t\t\telementSplit = String(assignables.split);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (assignables[\"container-delay\"]) {\n\t\t\t\t\t\t\tcontainerDelay = String(assignables[\"container-delay\"]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\telement.classList.add(...newClasses);\n\t\t\t\t\tif (speedClass) { element.classList.add(speedClass)}\n\t\t\t\t\tif (newDelay) {element.dataset.delay = newDelay};\n\t\t\t\t\tif (elementSplit) {element.dataset.split = elementSplit};\n\t\t\t\t\tif (containerDelay) {element.dataset.containerDelay = containerDelay};\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n}\n","import { copyDataAttributes } from '../helpers';\n\n/**\n * Hoist a list item's appearance to its parent element's appearance.\n *\n * @param {HTMLElement} from - The list item element.\n * @returns {undefined}\n */\nconst hoistAppearance = (from, baseclass) => {\n\tlet to = from.parentNode;\n\tif (!to) return;\n  \n\tfor (const sibling of to.children) {\n\t  if (sibling !== from && sibling.dataset.appearParent) return;\n\t}\n  \n\tto.classList = from.classList;\n\tcopyDataAttributes(from, to, \"data-appear-parent\");\n\tto.innerHTML = from.innerHTML;\n\tto.classList.add(baseclass);\n};\n\n\n/**\n * Fix list items that were changed by Quarto.\n *\n * This function is designed for use with Quarto and handles the conversion of list items\n * with Appearance classes to their parent elements when a manual attribute is present.\n * It also provides automatic conversion for list items that directly contain spans, which\n * is related to Quarto's wrapping of list content in a span.\n *\n * @param {HTMLElement} appearance - The list item element whose appearance will be converted.\n * @param {Object} options - An options object that controls the conversion behavior.\n * @param {boolean} options.appearparents - If `true`, automatic conversion of list items with spans is enabled.\n * @returns {undefined}\n */\nexport const fixListItem = (appearance, options, names) => {\n\n\tlet baseclass = names.baseclass\n\tif (appearance.hasAttribute(\"data-appear-parent\")) {\n\t\thoistAppearance(appearance, baseclass);\n\t}\n\n\tif (options.appearparents) {\n\t\tif (appearance.parentNode && appearance.parentNode.tagName) {\n\t\t\tif (appearance.tagName == \"SPAN\" && appearance.parentNode.tagName == \"LI\") {\n\t\t\t\tlet spanLength = String(appearance.outerHTML).length;\n\t\t\t\tlet liContentLength = String(appearance.parentNode.innerHTML).length;\n\t\t\t\tif (spanLength == liContentLength) {\n\t\t\t\t\thoistAppearance(appearance);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","/**\n * Adds a base class to an HTML element if it doesn't already have it.\n *\n * This function checks if the specified HTML element has the specified base class,\n * and if not, it adds the base class to the element's class list.\n *\n * @param {HTMLElement} appearance - The HTML element to which the base class should be added.\n * @param {Object} names - The existing 'names' object\n * @returns {undefined}\n */\n\nexport const addBaseClass = (appearance, names) => {\n\tif (!appearance.classList.contains(names.baseclass)) {\n\t\tappearance.classList.add(names.baseclass);\n\t}\n\tif (appearance.classList.contains(names.fragmentClass)) {\n\t\tappearance.classList.add('custom');\n\t}\n}\n","export const addDelay = (appearanceArray, options, names) => {\n\n    let delay = 0;\n    appearanceArray.forEach((appearance, index) => {\n\n        if ((index == 0 && appearance.dataset.delay) || index !=0) {\n\n            let elementDelay = options.delay;\n\n            if (appearance.dataset && appearance.dataset.delay) {\n                elementDelay = parseInt(appearance.dataset.delay);\n            }\n\n            delay = delay + elementDelay;\n\n            appearance.style.setProperty('animation-delay', delay + \"ms\");\n            appearance.removeAttribute('data-delay');\n        }\n\n    })\n\n}\n","/**\n * Selects elements with a specified class that are not nested inside an element with another specified class.\n * @param {string} targetClass - The class name to select elements.\n * @param {string} excludeClass - The class name to exclude elements nested inside it.\n * @param {Element} el - The element to find the target elements in.\n * @returns {Element[]} - Array of selected elements.\n */\nconst elemsNotInClass = (targetClass, excludeClass, el) => \n    Array.from(el.querySelectorAll(`.${targetClass}`))\n        .filter(s => !s.closest(`.${excludeClass}`));\n\n/**\n * Selects elements with a specified class that are nested inside an element with another specified class.\n * @param {string} targetClass - The class name to select elements.\n * @param {string} parentClass - The class name of the parent to find elements in.\n * @param {Element} el - The element to find the target elements in.\n * @returns {Element[]} - Array of selected elements.\n */\nconst elemsInClass = (targetClass, parentClass, el) =>\n    Array.from(el.querySelectorAll(`.${targetClass}`))\n        .filter(s => s.closest(`.${parentClass}`) === el);\n\n/**\n * Extracts groups of elements with a specified class from the provided section element.\n * Groups are formed based on nesting inside elements with another specified class.\n * @param {Element} section - The section to extract data from.\n * @returns {Element[][]} - Nested arrays of selected elements.\n */\n\n\n/**\n * Extracts groups of elements with a specified class from the provided section element.\n * Groups are formed based on nesting inside elements with another specified class.\n * @param {Element} section - The section to extract data from.\n * @param {string} targetClass - The class name to select elements.\n * @param {string} groupClass - The class name of the parent to find elements in.\n * @returns {Element[][]} - Nested arrays of selected elements.\n */\nexport const getAppearanceArrays = (section, targetClass, groupClass) => {\n    const result = [\n        elemsNotInClass(targetClass, groupClass, section), \n        ...Array.from(section.querySelectorAll(`.${groupClass}`))\n            .map(frag => elemsInClass(targetClass, groupClass, frag))\n    ];\n\n\tif (result.some(group => group.length > 0)) {\n        return result;\n    } else {\n\t\treturn false;\n\t}\n};\n","export const convertToSpans = (parent, kind) => {\n\n\tlet splitElements = false;\n\tlet joinChar = ' ';\n\n\tif (kind == \"words\") {\n\t\tsplitElements = parent.textContent.trim().split(/\\s+/);\n\t\t\n\t} else if (kind == \"letters\") {\n\t\tsplitElements = parent.textContent.trim().split('');\n\t\tjoinChar = '';\n\t}\n\n\tif (splitElements) {\n\t\tconst parentAnimateClasses = Array.from(parent.classList).filter(className => className.startsWith('animate__'));\n\t\n\t\tconst newHtml = splitElements.map((element, index) => {\n\t\t\tconst span = document.createElement('span');\n\t\t\tspan.textContent = element;\n\t\t\tif (element == \" \") {span.textContent = \"\\u00A0\"}\n\t\n\t\t\tif (parent.dataset.delay && index !== 0) {\n\t\t\t\tspan.dataset.delay = parent.dataset.delay\n\t\t\t}\n\n\t\t\tif (parent.dataset.containerDelay && index === 0) {\n\t\t\t\tspan.dataset.delay = parent.dataset.containerDelay\n\t\t\t}\n\t\n\t\t\tparent.classList.forEach(className => className.startsWith('animate__') && span.classList.add(className));\n\t\t\treturn span.outerHTML;\n\t\t\t\n\t\t}).join(joinChar);\n\t\n\t\tparentAnimateClasses.forEach(className => parent.classList.remove(className));\n\t\tparent.removeAttribute('data-delay');\n\t\tparent.removeAttribute('data-split');\n\t\tparent.removeAttribute('data-container-delay');\n\t\n\t\tparent.innerHTML = newHtml;\n\t}\n\n\n};","/**\n * Derives slide from and to from the event object.\n *\n * @param {Object} event - The event object containing slide transition details.\n * @returns {Object} - An object containing references to the \"from\" and \"to\" slides.\n */\nconst fromTo = (event) => {\n\tlet slides = {};\n\tslides.from = event.fromSlide || event.previousSlide || null;\n\tslides.to = event.toSlide || event.currentSlide || null;\n\treturn slides;\n};\n\n/**\n * A function that determines the appearance event for a given slide.\n *\n * This function checks the `data-appearevent` attribute of the slide and the `options.appearevent` parameter.\n * If `data-appearevent` is set to \"auto\", it is converted to \"autoanimate\". If `options.appearevent` is \"auto\", it is also converted to \"autoanimate\".\n * The function returns the appearance event, prioritizing `data-appearevent` over `options.appearevent`.\n *\n * @param {HTMLElement} toSlide - The slide for which the appearance event is determined.\n * @param {Object} options - An object containing options for the appearance event.\n * @param {string} options.appearevent - The appearance event option provided in the `options` object.\n *\n * @returns {string} - The determined appearance event for the slide, either from `data-appearevent` or `options.appearevent`.\n */\nconst slideAppearevent = (toSlide, options) => {\n\n\tif (toSlide.dataset.appearevent && toSlide.dataset.appearevent === \"auto\" ) {\n\t\ttoSlide.dataset.appearevent = \"autoanimate\"\n\t}\n\tif (options.appearevent == \"auto\") {options.appearevent = \"autoanimate\"}\n\treturn toSlide.dataset.appearevent ? toSlide.dataset.appearevent : options.appearevent;\n};\n\n/**\n * Remove the 'data-appearance-can-start' attribute from the 'from' slide if the 'hideagain' option is enabled.\n *\n * @param {HTMLElement} slides - The container element for the slides.\n * @param {Object} options - An object containing configuration options.\n * @param {boolean} options.hideagain - A flag indicating whether to remove the attribute when 'hideagain' is true.\n */\nconst removeStartAttribute = (slides, options) => {\n\tif (options.hideagain) {\n\t\tif (slides.from && slides.from.dataset.appearanceCanStart ) {\n\t\t\tslides.from.removeAttribute('data-appearance-can-start');\n\t\t}\n\t}\n};\n\n\n/**\n * Turn off slide appearances when transitioning from one slide to another if the 'hideagain' option is enabled.\n *\n * @param {HTMLElement} slides - The container element for the slides.\n * @param {Object} options - An object containing configuration options.\n * @param {string} names.animatecss - The CSS selector for animated elements.\n */\nconst turnOffSlideAppearances = (slides, options, names) => {\n\tif (options.hideagain) {\n\t\tlet fromAppearances = slides.from.querySelectorAll(names.animatecss);\n\t\tfromAppearances.forEach( appearance => {\n\t\t\tappearance.classList.remove('animationended');\n\t\t} );\n\t\t// Remove visible class from fragments when moving away from that slide\n\t\tlet fromFragments = slides.from.querySelectorAll(`.fragment.visible`);\n\t\tif (fromFragments) {\n\t\t\tfromFragments.forEach(fragment => {\n\t\t\t\tfragment.classList.remove('visible');\n\t\t\t})\n\t\t}\n\t}\n};\n\n\n/**\n * Handles the showing and hiding of slides based on the provided event and options.\n *\n * @param {Object} event - The event object containing slide transition details.\n * @param {Object} options - An object containing configurations for slide appearance management.\n */\nexport const showHideSlide = (event, options, names, vars) => {\n\n\tlet view = vars.deck.getConfig().view;\n\tlet etype = event.type;\n\tlet slides = fromTo(event);\n\n\tif (slides.to) {\n\n\t\tif (etype == \"ready\") {\n\t\t\tslides.to.dataset.appearanceCanStart = true;\n\t\t}\n\n\t\tlet appearevent = slideAppearevent(slides.to, options)\n\n\t\tif (etype == appearevent || (etype == \"slidetransitionend\" && appearevent == \"autoanimate\")) {\n\t\t\tslides.to.dataset.appearanceCanStart = true;\n\t\t}\n\n\t\t// Add experimental Reader mode compatibility, does not have a slidetransitionend event yet\n\t\tif (view == \"scroll\" && etype == 'slidechanged' ) {\n\n\t\t\tremoveStartAttribute(slides, options);\n\t\t\tturnOffSlideAppearances(slides, options, names);\n\n\t\t\t// Add delay to allow for scroll animation to finish\n\t\t\tsetTimeout(() => {\n\t\t\t\tslides.to.dataset.appearanceCanStart = true;\n\t\t\t}, options.delay)\n\t\t}\n\n\n\t\tif (etype == \"slidetransitionend\" ) {\n\n\t\t\tremoveStartAttribute(slides, options);\n\t\t\tturnOffSlideAppearances(slides, options, names);\n\t\t}\n\t\t\n\t\tif (etype == 'slidechanged' && document.body.dataset.exitoverview) {\n\t\t\tremoveStartAttribute(slides, options);\n\t\t\tslides.to.dataset.appearanceCanStart = true;\n\n\t\t} else if (etype == 'overviewhidden' ) {\n\n\t\t\tdocument.body.dataset.exitoverview = true;\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tdocument.body.removeAttribute('data-exitoverview')\n\t\t\t}, 500)\n\n\t\t\tif (event.currentSlide ) {\n\t\t\t\tremoveStartAttribute(slides, options);\n\t\t\t\tslides.to.dataset.appearanceCanStart = true;\n\t\t\t}\n\t\t}\n\t}\n}","import { debugLog, mergeDeep, doneLoading, isStack } from './helpers';\n\nimport {getAndLoadCSS} from './functions/get-load-css.js';\nimport {addAutoAnimation} from './functions/add-auto-animation.js';\nimport {fixListItem} from './functions/fix-list-item';\nimport {addBaseClass} from './functions/add-base-class.js';\nimport {addDelay} from './functions/add-delay.js';\nimport {getAppearanceArrays} from './functions/get-appearance-arrays.js';\nimport {convertToSpans} from './functions/convert-to-spans';\nimport {showHideSlide} from './functions/show-hide-slide.js';\n\n\nconst Plugin = () => {\n\n\tconst vars = {};\n\tvars.names = {};\n\tlet options = {};\n\n\t/**\n\t* Prepare the plugin to find Appearance elements\n\t* @param {Object} vars - The variables to be prepared.\n\t* @param {Object} names - The names to be prepared.\n\t* @param {Function} resolve - The callback function to be called when preparation is complete.\n\t* @throws {Error} Throws an error if the 'options' object is not defined.\n\t*/\n\tconst prepare = (options, vars, resolve) => {\n\n\t\tdebugLog(options, \"-------------   Preloading   -------------\");\n\n\t\tlet names = vars.names;\n\n\t\tgetAndLoadCSS(options, names.es5Filename);\n\n\t\tif (options.compatibility) {\n\t\t\tnames.animatecss = '.backInDown, .backInLeft, .backInRight, .backInUp, .bounceIn, .bounceInDown, .bounceInLeft, .bounceInRight, .bounceInUp, .fadeIn, .fadeInDown, .fadeInDownBig, .fadeInLeft, .fadeInLeftBig, .fadeInRight, .fadeInRightBig, .fadeInUp, .fadeInUpBig, .fadeInTopLeft, .fadeInTopRight, .fadeInBottomLeft, .fadeInBottomRight, .flipInX, .flipInY, .lightSpeedInRight, .lightSpeedInLeft, .rotateIn, .rotateInDownLeft, .rotateInDownRight, .rotateInUpLeft, .rotateInUpRight, .jackInTheBox, .rollIn, .zoomIn, .zoomInDown, .zoomInLeft, .zoomInRight, .zoomInUp, .slideInDown, .slideInLeft, .slideInRight, .slideInUp, .skidLeft, .skidLeftBig, .skidRight, .skidRightBig, .shrinkIn, .shrinkInBlur';\n\t\t\tnames.baseclass = options.compatibilitybaseclass\n\t\t}\n\n\t\tvars.appearances = Array.from(vars.slides.querySelectorAll(names.animatecss));\n\n\t\t// Go through each section to see if there are any (auto) selectors that need animation classes\n\t\tvars.regularSections.forEach(theSection => addAutoAnimation(theSection, options, vars));\n\n\t\tvars.appearances.forEach((theAppearance, index) => {\n\t\t\t// Fix any list item where the Appearance classes were moved to the span (Quarto does this)\n\t\t\tfixListItem(theAppearance, options, names);\n\n\t\t\t// Go through each appearance element and add the baseclass if it doesn't have it\n\t\t\taddBaseClass(theAppearance, names);\n\n\t\t\tif (theAppearance.hasAttribute('data-split')) {\n\t\t\t\tconvertToSpans(theAppearance, theAppearance.dataset.split);\n\t\t\t}\n\t\t});\n\n\t\tvars.regularSections.forEach((theSection, index) => {\n\t\t\t// Get all the Appearances in the section as separate arrays per delay loop\n\t\t\tlet appearanceArrays = getAppearanceArrays(theSection, names.baseclass, names.fragmentClass);\n\n\t\t\tif (appearanceArrays) {\n\t\t\t\tappearanceArrays.forEach((appearanceArray) => {\n\t\t\t\t\t// Add the delays to each appearance in the array\n\t\t\t\t\taddDelay(appearanceArray, options, names)\n\t\t\t\t})\n\t\t\t}\n\t\t});\n\n\t\tdoneLoading(resolve);\n\t}\n\n\t/**\n\t* The main function of the plugin\n\t* @param {object} deck - The deck object\n\t* @param {object} options - The options object\n\t* @param {string} es5Filename - The name of the file that will be used\n\t*/\n\tconst Appear = function (deck, options, es5Filename) {\n\n\t\tlet names = vars.names;\n\n\t\t// Set up names\n\t\tnames.baseclass = options.baseclass;\n\t\tnames.compatibilitybaseclass = options.compatibilitybaseclass;\n\t\tnames.fragmentSelector = \".fragment\";\n\t\tnames.fragmentClass = \"fragment\";\n\t\tnames.speedClasses = ['slower', 'slow', 'fast', 'faster'];\n\t\tnames.speedClasses.push(...names.speedClasses.map(speed => `animate__${speed}`));\n\t\tnames.animatecss = '[class^=\"animate__\"],[class*=\" animate__\"]';\n\t\tnames.es5Filename = es5Filename;\n\t\tnames.eventnames = ['ready', 'slidechanged', 'slidetransitionend', 'autoanimate', 'overviewhidden', 'scrolle'];\n\t\n\t\t// Set up variables\n\t\tvars.deck = deck;\n\t\tvars.dom = deck.getRevealElement();\n\t\tvars.viewport = deck.getViewportElement();\n\t\tvars.slides = deck.getSlidesElement();\n\n\t\tvars.sections = vars.slides.querySelectorAll('section');\n\t\tvars.fragments = vars.slides.querySelectorAll(names.fragmentSelector);\n\t\tvars.regularSections = Array.from(vars.sections).filter( section => !isStack(section));\n\n\t\tif( /receiver/i.test( window.location.search ) ) vars.viewport.classList.add('sv');\n\n\t\tnames.eventnames.forEach( (eventname) => deck.on( eventname, event => { showHideSlide(event, options, names, vars) } ) );\n\n\t\tvars.viewport.addEventListener(\"animationend\", (event) => {\n\t\t\tevent.target.classList.add('animationended');\n\t\t});\n\t\tvars.viewport.addEventListener(\"fragmenthidden\", (event) => {\n\t\t\tevent.fragment.classList.remove('animationended');\n\t\t\tevent.fragment.querySelectorAll('.animationended').forEach(el => {\n\t\t\t\tel.classList.remove('animationended');\n\t\t\t});\n\t\t});\n\n\t\treturn new Promise(resolve => {\n\t\t\tprepare(options, vars, resolve);\n\t\t\tdebugLog(options, \"----------   Done preloading   ----------\");\n\t\t});\n\t};\n\n\n\t/**\n\t* Initialize the plugin\n\t* @param {object} deck - The deck object\n\t*/\n\tconst init = function (deck) {\n\n\t\tlet defaultOptions = {\n\t\t\tbaseclass: 'animate__animated',\n\t\t\thideagain: true,\n\t\t\tdelay: 300,\n\t\t\tdebug: false,\n\t\t\tappearevent: 'slidetransitionend',\n\t\t\tautoappear: false,\n\t\t\tautoelements: false,\n\t\t\tappearparents: false,\n\t\t\tcsspath: '',\n\t\t\tanimatecsspath: {\n\t\t\t\tlink : 'https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css',\n\t\t\t\tcompat : 'https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.compat.css',\n\t\t\t},\n\t\t\tcompatibility: false,\n\t\t\tcompatibilitybaseclass: 'animated'\n\t\t};\n\n\t\toptions = mergeDeep(defaultOptions, deck.getConfig().appearance || {});\n\n\t\treturn Appear(deck, options, \"appearance.js\");\n\t};\n\n\treturn { id: 'appearance', init: init };\n};\n\nexport default Plugin;"],"names":["isJSON","str","JSON","parse","e","isStack","_ref","childNodes","i","length","tagName","copyDataAttributes","_ref2","target","not","attributes","filter","_ref3","nodeName","includes","forEach","_ref4","nodeValue","setAttribute","isObject","item","Array","isArray","mergeDeep","_len","arguments","sources","_key","source","shift","key","Object","assign","doneLoading","resolve","setTimeout","toJSONString","JSONString","replace","stringify","trim","charAt","loadStyle","url","callback","head","document","querySelector","style","createElement","rel","href","onload","call","onreadystatechange","readyState","appendChild","pluginPath","fileName","path","pluginScript","getAttribute","slice","import","meta","lastIndexOf","debugLog","options","text","debug","console","log","getAndLoadCSS","thePath","pluginBaseName","AppearanceStylePath","csspath","appearance","AnimateCSSPath","compatibility","animatecsspath","link","compat","addAutoAnimation","section","vars","sectionAutoSelectors","hasAttribute","sectDataAppear","dataset","autoappear","autoelements","elementsToAnimate","entries","selector","assignables","elements","from","querySelectorAll","element","appearances","push","newClasses","newDelay","speedClass","elementSplit","containerDelay","split","constructor","class","animation","animationClass","speed","String","delay","classList","add","hoistAppearance","baseclass","to","parentNode","sibling","children","appearParent","innerHTML","fixListItem","names","appearparents","spanLength","outerHTML","liContentLength","addBaseClass","contains","fragmentClass","addDelay","appearanceArray","index","elementDelay","parseInt","setProperty","removeAttribute","elemsNotInClass","targetClass","excludeClass","el","s","closest","elemsInClass","parentClass","getAppearanceArrays","groupClass","result","map","frag","some","group","convertToSpans","parent","kind","splitElements","joinChar","textContent","parentAnimateClasses","className","startsWith","newHtml","span","join","remove","fromTo","event","slides","fromSlide","previousSlide","toSlide","currentSlide","slideAppearevent","appearevent","removeStartAttribute","hideagain","appearanceCanStart","turnOffSlideAppearances","fromAppearances","animatecss","fromFragments","fragment","showHideSlide","view","deck","getConfig","etype","type","body","exitoverview","Plugin","prepare","es5Filename","compatibilitybaseclass","regularSections","theSection","theAppearance","appearanceArrays","Appear","fragmentSelector","speedClasses","eventnames","dom","getRevealElement","viewport","getViewportElement","getSlidesElement","sections","fragments","test","window","location","search","eventname","on","addEventListener","Promise","init","defaultOptions","id"],"mappings":"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"}