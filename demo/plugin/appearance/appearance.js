(function(p,L){typeof exports=="object"&&typeof module<"u"?module.exports=L():typeof define=="function"&&define.amd?define(L):(p=typeof globalThis<"u"?globalThis:p||self,p.Appearance=L())})(this,(function(){"use strict";var p=typeof document<"u"?document.currentScript:null;function L(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var O,R;function z(){if(R)return O;R=1;var t=function(l){return e(l)&&!n(l)};function e(r){return!!r&&typeof r=="object"}function n(r){var l=Object.prototype.toString.call(r);return l==="[object RegExp]"||l==="[object Date]"||c(r)}var a=typeof Symbol=="function"&&Symbol.for,i=a?Symbol.for("react.element"):60103;function c(r){return r.$$typeof===i}function s(r){return Array.isArray(r)?[]:{}}function f(r,l){return l.clone!==!1&&l.isMergeableObject(r)?m(s(r),r,l):r}function o(r,l,u){return r.concat(l).map(function(y){return f(y,u)})}function d(r,l){if(!l.customMerge)return m;var u=l.customMerge(r);return typeof u=="function"?u:m}function S(r){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(r).filter(function(l){return Object.propertyIsEnumerable.call(r,l)}):[]}function h(r){return Object.keys(r).concat(S(r))}function A(r,l){try{return l in r}catch{return!1}}function I(r,l){return A(r,l)&&!(Object.hasOwnProperty.call(r,l)&&Object.propertyIsEnumerable.call(r,l))}function C(r,l,u){var y={};return u.isMergeableObject(r)&&h(r).forEach(function(g){y[g]=f(r[g],u)}),h(l).forEach(function(g){I(r,g)||(A(r,g)&&u.isMergeableObject(l[g])?y[g]=d(g,u)(r[g],l[g],u):y[g]=f(l[g],u))}),y}function m(r,l,u){u=u||{},u.arrayMerge=u.arrayMerge||o,u.isMergeableObject=u.isMergeableObject||t,u.cloneUnlessOtherwiseSpecified=f;var y=Array.isArray(l),g=Array.isArray(r),Ie=y===g;return Ie?y?u.arrayMerge(r,l,u):C(r,l,u):f(l,u)}m.all=function(l,u){if(!Array.isArray(l))throw new Error("first argument should be an array");return l.reduce(function(y,g){return m(y,g,u)},{})};var w=m;return O=w,O}var k=z();const B=L(k);let E=null;const F=()=>{if(E)return E;const t=typeof window<"u",e=typeof document<"u";let n=!1;try{const i=new Function('return typeof module !== "undefined" && !!module.hot')(),c=new Function('return typeof import.meta !== "undefined" && !!import.meta.hot')();n=i||c}catch{}let a=!1;try{a=new Function('return typeof import.meta !== "undefined" && import.meta.env?.DEV === true')()}catch{}return E={isDevelopment:n||a,hasHMR:n,isViteDev:a,hasWindow:t,hasDocument:e},E};class V{defaultConfig;pluginInit;pluginId;mergedConfig=null;userConfigData=null;data={};constructor(e,n,a){typeof e=="string"?(this.pluginId=e,this.pluginInit=n,this.defaultConfig=a||{}):(this.pluginId=e.id,this.pluginInit=e.init,this.defaultConfig=e.defaultConfig||{})}initializeConfig(e){const n=this.defaultConfig,a=e.getConfig()[this.pluginId]||{};this.userConfigData=a,this.mergedConfig=B(n,a,{arrayMerge:(i,c)=>c,clone:!0})}getCurrentConfig(){if(!this.mergedConfig)throw new Error("Plugin configuration has not been initialized");return this.mergedConfig}getData(){return Object.keys(this.data).length>0?this.data:void 0}get userConfig(){return this.userConfigData||{}}getEnvironmentInfo=()=>F();init(e){if(this.initializeConfig(e),this.pluginInit)return this.pluginInit(this,e,this.getCurrentConfig())}createInterface(e={}){return{id:this.pluginId,init:n=>this.init(n),getConfig:()=>this.getCurrentConfig(),getData:()=>this.getData(),...e}}}const J=t=>{const e=document.querySelector(`script[src$="${t}.js"], script[src$="${t}.min.js"], script[src$="${t}.mjs"]`);if(e?.src){const n=e.getAttribute("src")||"",a=n.lastIndexOf("/");if(a!==-1)return n.substring(0,a+1)}try{if(typeof{url:typeof document>"u"&&typeof location>"u"?require("url").pathToFileURL(__filename).href:typeof document>"u"?location.href:p&&p.tagName.toUpperCase()==="SCRIPT"&&p.src||new URL("plugin/appearance/appearance.js",document.baseURI).href}<"u"&&(typeof document>"u"&&typeof location>"u"?require("url").pathToFileURL(__filename).href:typeof document>"u"?location.href:p&&p.tagName.toUpperCase()==="SCRIPT"&&p.src||new URL("plugin/appearance/appearance.js",document.baseURI).href))return(typeof document>"u"&&typeof location>"u"?require("url").pathToFileURL(__filename).href:typeof document>"u"?location.href:p&&p.tagName.toUpperCase()==="SCRIPT"&&p.src||new URL("plugin/appearance/appearance.js",document.baseURI).href).slice(0,(typeof document>"u"&&typeof location>"u"?require("url").pathToFileURL(__filename).href:typeof document>"u"?location.href:p&&p.tagName.toUpperCase()==="SCRIPT"&&p.src||new URL("plugin/appearance/appearance.js",document.baseURI).href).lastIndexOf("/")+1)}catch{}return`plugin/${t}/`},_="data-css-id",G=(t,e)=>new Promise((n,a)=>{const i=document.createElement("link");i.rel="stylesheet",i.href=e,i.setAttribute(_,t);const c=setTimeout(()=>{i.parentNode&&i.parentNode.removeChild(i),a(new Error(`[${t}] Timeout loading CSS from: ${e}`))},5e3);i.onload=()=>{clearTimeout(c),n()},i.onerror=()=>{clearTimeout(c),i.parentNode&&i.parentNode.removeChild(i),a(new Error(`[${t}] Failed to load CSS from: ${e}`))},document.head.appendChild(i)}),j=t=>document.querySelectorAll(`[${_}="${t}"]`).length>0,W=t=>new Promise(e=>{if(n())return e(!0);setTimeout(()=>{e(n())},50);function n(){if(j(t))return!0;try{return window.getComputedStyle(document.documentElement).getPropertyValue(`--cssimported-${t}`).trim()!==""}catch{return!1}}}),U=async t=>{const{id:e,cssautoload:n=!0,csspath:a="",debug:i=!1}=t;if(n===!1||a===!1)return;if(j(e)&&!(typeof a=="string"&&a.trim()!=="")){i&&console.log(`[${e}] CSS is already loaded, skipping`);return}j(e)&&typeof a=="string"&&a.trim()!==""&&i&&console.log(`[${e}] CSS is already loaded, also loading user-specified path: ${a}`);const c=[];typeof a=="string"&&a.trim()!==""&&c.push(a);const s=J(e);if(s){const o=`${s}${e}.css`;c.push(o)}const f=`plugin/${e}/${e}.css`;c.push(f);for(const o of c)try{await G(e,o);let d="CSS";a&&o===a?d="user-specified CSS":s&&o===`${s}${e}.css`?d="CSS (auto-detected from script location)":d="CSS (standard fallback)",i&&console.log(`[${e}] ${d} loaded successfully from: ${o}`);return}catch{i&&console.log(`[${e}] Failed to load CSS from: ${o}`)}console.warn(`[${e}] Could not load CSS from any location`)};async function K(t,e){if("getEnvironmentInfo"in t&&e){const n=t,a=n.getEnvironmentInfo();if(await W(n.pluginId)&&!(typeof e.csspath=="string"&&e.csspath.trim()!=="")){e.debug&&console.log(`[${n.pluginId}] CSS is already imported, skipping`);return}if("cssautoload"in n.userConfig?e.cssautoload:!a.isDevelopment)return U({id:n.pluginId,cssautoload:!0,csspath:e.csspath,debug:e.debug});a.isDevelopment&&console.warn(`[${n.pluginId}] CSS autoloading is disabled in bundler environments. Please import the CSS manually, using import.`);return}return U(t)}class Y{debugMode=!1;label="DEBUG";groupDepth=0;initialize(e,n="DEBUG"){this.debugMode=e,this.label=n}group=(...e)=>{this.debugLog("group",...e),this.groupDepth++};groupCollapsed=(...e)=>{this.debugLog("groupCollapsed",...e),this.groupDepth++};groupEnd=()=>{this.groupDepth>0&&(this.groupDepth--,this.debugLog("groupEnd"))};error=(...e)=>{const n=this.debugMode;this.debugMode=!0,this.formatAndLog(console.error,e),this.debugMode=n};table=(e,n,a)=>{if(this.debugMode)try{typeof e=="string"&&n!==void 0&&typeof n!="string"?(this.groupDepth===0?console.log(`[${this.label}]: ${e}`):console.log(e),a?console.table(n,a):console.table(n)):(this.groupDepth===0&&console.log(`[${this.label}]: Table data`),typeof n=="object"&&Array.isArray(n)?console.table(e,n):console.table(e))}catch(i){console.error(`[${this.label}]: Error showing table:`,i),console.log(`[${this.label}]: Raw data:`,e)}};formatAndLog=(e,n)=>{if(this.debugMode)try{this.groupDepth>0?e.call(console,...n):n.length>0&&typeof n[0]=="string"?e.call(console,`[${this.label}]: ${n[0]}`,...n.slice(1)):e.call(console,`[${this.label}]:`,...n)}catch(a){console.error(`[${this.label}]: Error in logging:`,a),console.log(`[${this.label}]: Original log data:`,...n)}};debugLog(e,...n){const a=console[e];if(!this.debugMode&&e!=="error"||typeof a!="function")return;const i=a;if(e==="group"||e==="groupCollapsed"){n.length>0&&typeof n[0]=="string"?i.call(console,`[${this.label}]: ${n[0]}`,...n.slice(1)):i.call(console,`[${this.label}]:`,...n);return}if(e==="groupEnd"){i.call(console);return}if(e==="table"){n.length===1?this.table(n[0]):n.length===2?typeof n[0]=="string"?this.table(n[0],n[1]):this.table(n[0],n[1]):n.length>=3&&this.table(n[0],n[1],n[2]);return}this.groupDepth>0?i.call(console,...n):n.length>0&&typeof n[0]=="string"?i.call(console,`[${this.label}]: ${n[0]}`,...n.slice(1)):i.call(console,`[${this.label}]:`,...n)}}const X=t=>new Proxy(t,{get:(e,n)=>{if(n in e)return e[n];const a=n.toString();if(typeof console[a]=="function")return(...i)=>{e.debugLog(a,...i)}}}),b=X(new Y);var H=(t=>(t.HORIZONTAL="horizontal",t.STACK="stack",t.VERTICAL="vertical",t.INVALID="invalid",t))(H||{});const v=t=>t instanceof HTMLElement&&t.tagName==="SECTION",$=t=>v(t)?Array.from(t.children).some(e=>e instanceof HTMLElement&&e.tagName==="SECTION"):!1,T=t=>v(t)?t.parentElement instanceof HTMLElement&&t.parentElement.tagName==="SECTION":!1,Z=t=>v(t)&&!T(t)&&!$(t),Q=t=>{if(!v(t))return null;if(T(t)){const e=t.parentElement;if(e instanceof HTMLElement&&$(e))return e}return null},ee=t=>v(t)?T(t)?"vertical":$(t)?"stack":"horizontal":"invalid",te=Object.freeze(Object.defineProperty({__proto__:null,SectionType:H,getSectionType:ee,getStack:Q,isHorizontal:Z,isSection:v,isStack:$,isVertical:T},Symbol.toStringTag,{value:"Module"})),ne={baseclass:"animate__animated",hideagain:!0,delay:300,appearevent:"slidetransitionend",autoappear:!1,autoelements:!1,appearparents:!1,initdelay:0,cssautoload:!0,csspath:"",compatibility:!1,compatibilitybaseclass:"animated"};function ae(t,e,n){const a={baseclass:t,compatibilitybaseclass:e,fragmentSelector:".fragment",fragmentClass:"fragment",speedClasses:["slower","slow","fast","faster"],animatecss:'[class^="animate__"],[class*=" animate__"]',eventnames:["ready","slidechanged","slidetransitionend","autoanimate","overviewhidden"]};return a.speedClasses=[...a.speedClasses,...a.speedClasses.map(i=>`animate__${i}`)],n&&(a.animatecss=".backInDown, .backInLeft, .backInRight, .backInUp, .bounceIn, .bounceInDown, .bounceInLeft, .bounceInRight, .bounceInUp, .fadeIn, .fadeInDown, .fadeInDownBig, .fadeInLeft, .fadeInLeftBig, .fadeInRight, .fadeInRightBig, .fadeInUp, .fadeInUpBig, .fadeInTopLeft, .fadeInTopRight, .fadeInBottomLeft, .fadeInBottomRight, .flipInX, .flipInY, .lightSpeedInRight, .lightSpeedInLeft, .rotateIn, .rotateInDownLeft, .rotateInDownRight, .rotateInUpLeft, .rotateInUpRight, .jackInTheBox, .rollIn, .zoomIn, .zoomInDown, .zoomInLeft, .zoomInRight, .zoomInUp, .slideInDown, .slideInLeft, .slideInRight, .slideInUp, .skidLeft, .skidLeftBig, .skidRight, .skidRightBig, .shrinkIn, .shrinkInBlur",a.baseclass=e),a}const ie=t=>{try{return JSON.parse(t)&&!!t}catch{return!1}},M=t=>{if(t==null)return"";let e="",n=t;return typeof n=="string"&&(n=n.replace(/[“”]/g,'"').replace(/[‘’]/g,"'")),ie(t)?e=t:typeof t=="object"?e=JSON.stringify(t,null,2):typeof t=="string"&&(e=t.trim().replace(/'/g,'"').charAt(0)==="{"?t.trim().replace(/'/g,'"'):`{${t.trim().replace(/'/g,'"')}}`),e},re=(t,e,n)=>{for(const a of Array.from(t.attributes))a.nodeName.startsWith("data")&&a.nodeName!==n&&e.setAttribute(a.nodeName,a.nodeValue||"")},se=t=>{const e=document.createElement("textarea");return e.innerHTML=t,e.value},oe=t=>typeof t=="object"&&t!==null,le=(t,e,n)=>{let a=null;if(t instanceof HTMLElement&&t.hasAttribute("data-autoappear")){const i=t.dataset.autoappear;if(i==="auto"||i===""||i==="true")if(typeof e.autoelements=="string")try{a=JSON.parse(e.autoelements)}catch(s){b.log(`Error parsing global autoelements string: ${s} (${e.autoelements})`),a=null}else a=e.autoelements&&typeof e.autoelements=="object"?e.autoelements:null;else try{a=i?JSON.parse(M(se(i))):null}catch(s){b.log(`Error parsing data-autoappear: ${s} (${i})`),a=null}}else if(e.autoappear&&e.autoelements)if(typeof e.autoelements=="string")try{a=JSON.parse(M(e.autoelements))}catch(i){b.log(`Error parsing global autoelements string: ${i} (${e.autoelements})`),a=null}else typeof e.autoelements=="object"&&(a=e.autoelements);if(a)try{const i=JSON.parse(M(a));for(const[c,s]of Object.entries(i)){const f=Array.from(t.querySelectorAll(c)).filter(S=>!n.includes(S));if(f.length===0)continue;let o=null,d=0;for(let S=0;S<f.length;S++){const h=f[S],A=h.parentElement;A!==o&&(o=A,d=0),n.push(h);let I=[],C=null,m=!1,w=null,r=null;if(Array.isArray(s))I=String(s[0]).split(/[ ,]+/),C=s[1]!==void 0?String(s[1]):null;else if(typeof s=="string")I=s.split(/[ ,]+/);else if(oe(s)){if(s.class||s.animation){const l=s.animation||s.class;I=String(l).split(/[ ,]+/)}s.speed&&(m=String(s.speed),m.includes("animate__")||(m=`animate__${m}`)),s.delay!==void 0&&(C=String(s.delay)),s.split!==void 0&&(w=String(s.split)),s["container-delay"]!==void 0&&(r=String(s["container-delay"]))}I.length>0&&h.classList.add(...I),m&&h.classList.add(m),h instanceof HTMLElement&&(r&&d===0?h.dataset.delay=r:C&&d>0&&!h.dataset.delay&&(h.dataset.delay=C),w&&(h.dataset.split=w)),d++}}}catch(i){b.log(e,`Error processing auto animations: ${i}`)}};function ce(t,e){t.classList.contains(e.baseclass)||t.classList.add(e.baseclass),t.classList.contains(e.fragmentClass)&&t.classList.add("custom")}function ue(t,e){let n=0;t.forEach((a,i)=>{if(i===0&&a instanceof HTMLElement&&a.dataset.delay||i!==0){let c=e.delay;if(a instanceof HTMLElement&&a.dataset&&a.dataset.delay){const s=Number.parseInt(a.dataset.delay,10);Number.isNaN(s)||(c=s)}n=n+c,a instanceof HTMLElement&&(a.style.setProperty("animation-delay",`${n}ms`),a.removeAttribute("data-delay"))}})}function fe(t,e){let n=!1,a=" ";if(t.textContent?.trim()&&(e==="words"?n=t.textContent.trim().split(/\s+/)||[]:e==="letters"&&(n=t.textContent.trim().split("")||[],a=""),n&&n.length>0)){const i=Array.from(t.classList).filter(s=>s.startsWith("animate__")),c=n.map((s,f)=>{const o=document.createElement("span");o.textContent=s===" "?" ":s,t.dataset.delay&&f!==0&&(o.dataset.delay=t.dataset.delay),t.dataset.containerDelay&&f===0&&(o.dataset.delay=t.dataset.containerDelay);for(let d=0;d<i.length;d++)o.classList.add(i[d]);return o.outerHTML}).join(a);t.classList.add("wordchargroup");for(let s=0;s<i.length;s++)t.classList.remove(i[s]);t.removeAttribute("data-delay"),t.removeAttribute("data-split"),t.removeAttribute("data-container-delay"),t.innerHTML=c}}function P(t,e){const n=t.parentNode;if(n){for(const a of Array.from(n.children))if(a!==t&&a.dataset.appearParent)return;n instanceof Element&&(n.classList.value=t.classList.value,re(t,n,"data-appear-parent"),n.innerHTML=t.innerHTML,e&&n.classList.add(e))}}function de(t,e,n){const a=n.baseclass;if(t.hasAttribute("data-appear-parent")&&P(t,a),e.appearparents&&t.parentNode&&t.parentNode instanceof Element&&t.tagName==="SPAN"&&t.parentNode.tagName==="LI"){const i=t.outerHTML.length,c=t.parentNode.innerHTML.length;i===c&&P(t)}}const pe=(t,e,n)=>Array.from(n.querySelectorAll(`.${t}`)).filter(a=>!a.closest(`.${e}`)),ge=(t,e,n)=>Array.from(n.querySelectorAll(`.${t}`)).filter(a=>a.closest(`.${e}`)===n),me=(t,e,n)=>{if(!e)return!1;const a=[pe(e,n,t),...Array.from(t.querySelectorAll(`.${n}`)).map(i=>ge(e,n,i))];return a.some(i=>i.length>0)?a:!1};function he(t){return{from:t.fromSlide||t.previousSlide||null,to:t.toSlide||t.currentSlide||null}}function ye(t,e){t.dataset.appearevent&&t.dataset.appearevent==="auto"&&(t.dataset.appearevent="autoanimate");let n=e.appearevent;return n==="auto"&&(n="autoanimate"),t.dataset.appearevent||n}function D(t,e){e.hideagain&&t.from&&t.from.dataset.appearanceCanStart&&t.from.removeAttribute("data-appearance-can-start")}function x(t,e,n){if(e.hideagain&&t&&t.from){const a=t.from.querySelectorAll(n.animatecss);if(a)for(const c of a)c.classList.remove("animationended");const i=t.from.querySelectorAll(".fragment.visible");if(i)for(const c of i)c.classList.remove("animationended")}}function be(t,e,n,a,i){const s=a.getViewportElement().classList.contains("reveal-scroll"),f=t.type,o=he(t);if(o.to){if(f==="ready"){const S=o.to.dataset.initDelay?parseInt(o.to.dataset.initDelay,10):e.initdelay||0;i.value&&S>0?setTimeout(()=>{o.to&&(o.to.dataset.appearanceCanStart="true"),i.value=!1},S):(o.to.dataset.appearanceCanStart="true",i.value=!1)}const d=ye(o.to,e);(f===d||f==="slidetransitionend"&&d==="autoanimate")&&(o.to.dataset.appearanceCanStart="true"),s&&f==="slidechanged"&&(D(o,e),x(o,e,n),setTimeout(()=>{o.to&&(o.to.dataset.appearanceCanStart="true")},e.delay)),f==="slidetransitionend"&&(D(o,e),x(o,e,n)),f==="slidechanged"&&document.body.dataset.exitoverview?(D(o,e),o.to.dataset.appearanceCanStart="true"):f==="overviewhidden"&&(document.body.dataset.exitoverview="true",setTimeout(()=>{document.body.removeAttribute("data-exitoverview")},500),t.currentSlide&&(D(o,e),o.to.dataset.appearanceCanStart="true"))}}class N{deck;viewport;slides;options;consts;sections;regularSections;appearances;isInitialLoad;constructor(e,n){this.deck=e,this.options=n,this.isInitialLoad=!0,this.viewport=e.getViewportElement(),this.slides=e.getSlidesElement(),this.consts=ae(n.baseclass,n.compatibilitybaseclass,n.compatibility),this.sections=this.slides.querySelectorAll("section"),this.regularSections=Array.from(this.sections).filter(a=>!te.isStack(a)),this.appearances=[],/receiver/i.test(window.location.search)&&this.viewport.classList.add("sv")}async prepareElements(){this.appearances=Array.from(this.slides.querySelectorAll(this.consts.animatecss));for(const e of this.regularSections)le(e,this.options,this.appearances);for(const e of this.appearances)de(e,this.options,this.consts),ce(e,this.consts),e instanceof HTMLElement&&e.dataset.split&&fe(e,e.dataset.split);for(const e of this.regularSections){const n=me(e,this.consts.baseclass,this.consts.fragmentClass);if(n)for(const a of n)ue(a,this.options)}}setupEventListeners(){b.log("Options:",this.options),b.log("Setting up event listeners");const e={value:this.isInitialLoad};for(const n of this.consts.eventnames)b.log(`Adding listener for ${n} event`),this.deck.on(n,a=>{be(a,this.options,this.consts,this.deck,e),this.isInitialLoad=e.value});this.viewport.addEventListener("animationend",n=>{n.target.classList.add("animationended")}),this.viewport.addEventListener("autoanimate",n=>{b.log("Autoanimate event triggered:",n)}),this.viewport.addEventListener("fragmenthidden",n=>{const a=n;if(a.fragment){a.fragment.classList.remove("animationended");const i=a.fragment.querySelectorAll(".animationended");for(const c of i)c.classList.remove("animationended")}})}static async create(e,n){const a=new N(e,n);return await a.prepareElements(),a.setupEventListeners(),a}}const q="appearance",Se=async(t,e,n)=>{b&&n.debug&&b.initialize(!0,q),await K(t,n),await N.create(e,n)};return()=>new V(q,Se,ne).createInterface()}));
